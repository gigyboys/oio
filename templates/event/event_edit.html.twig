{% extends "front.html.twig" %}

{% block title %}
  Edition de l'évènement #{{ event.id }}
{% endblock %}


{% block body %}
	<div class="cr">
		<div class="ct">
			<div class="mg_10">
                {{ include("event/include/header_event_edit.html.twig") }}

				{% if event.tovalid == false or event.valid %}
					<div class="meta_info mg_v10">
						<div class="meta_illustration" id="change_event_illustration" data-target="{{ path('event_manager_illustration_popup', {'event_id' : event.id})}}">
							{# twig extension #}
							{% set illustration = eventIllustration(event) %}
							<label>
								<img id="event_illustration" class="600x250" style="cursor: pointer" src="{{ illustration | imagine_filter('600x250') }}" alt="img event" />
							</label>
						</div>

						<div class="meta_title">
							<form id="form_event_edit" action="{{ path('event_manager_doedit', {'event_id': event.id}) }}">
								<div class="bloc_editable">
									<div class="bloc_view">
										<div class="pd_l5"><strong>Titre : <span class="error_title error_txt"></span></strong></div>
										<div style="padding:5px"><span id="event_view_title">{{ event.title }}</span></div>

										<div class="pd_l5"><strong>Slug :</strong></div>
										<div style="padding:5px"><span id="event_view_slug">{{ event.slug }}</span></div>

										<div class="pd_l5"><strong>Date début : <span class="error_datebegin error_txt"></span></strong></div>
										<div style="padding:5px"><span id="event_view_datebegin">{{ event.datebegin | date('d/m/Y à H:i') }}</span></div>

										<div class="pd_l5"><strong>Date fin : <span class="error_dateend error_txt"></span></strong></div>
										<div style="padding:5px"><span id="event_view_dateend">{{ event.dateend | date('d/m/Y à H:i') }}</span></div>

										<div class="pd_l5"><strong>Lieu : <span class="error_location error_txt"></span></strong></div>
										<div style="padding:5px"><span id="event_view_location">{{ event.location }}</span></div>

										<div class="pd_l5"><strong>Ville :</strong></div>
										<div style="padding:5px"><span id="event_view_city">{{ event.city }}</span></div>
									</div>
									<div class="bloc_edit" style="display:none">
										<div class="pd_l5">Titre *: <span class="error_title error_txt"></span></span></div>
										<div style="padding:5px"><input type="text" id="event_input_title" class="default_input" name="title" value="{{ event.title }}" /></div>
										
										<div class="pd_l5">Slug *:</div>
										<div style="padding:5px"><input type="text" id="event_input_slug" class="default_input" name="slug" value="{{ event.slug }}" /></div>
										
										<div class="pd_l5">Date début *:</div>
										<div style="padding:5px"><input type="text" readonly="true" id="event_input_datebegin" class="default_input" name="slug" value="{{ event.datebegin | date('d/m/Y à H:i') }}" /></div>
										
										<div class="pd_l5">Date fin *:</div>
										<div style="padding:5px"><input type="text" readonly="true" id="event_input_dateend" class="default_input" name="slug" value="{{ event.dateend | date('d/m/Y à H:i') }}" /></div>

										<div class="pd_l5"><strong>Lieu :</strong></div>
										<div style="padding:5px"><input type="text" id="event_input_location" class="default_input" required="required" value="{{ event.location }}" /></div>

										<div class="pd_l5"><strong>Ville :</strong></div>
										<div style="padding:5px"><input type="text" id="event_input_city" class="default_input" value="{{ event.city }}" /></div>
										
										<div class="pd_l5"><strong>Latitude :</strong></div>
										<div style="padding:5px">
											<input type="text" id="event_input_latitude" class="default_input" value="{{ event.latitude }}" />
											<span class="get-coords-event" style="cursor: pointer"><img src="{{ asset('image/location_icon.png') }}" style="width:12px; height:auto" /> map</span>
										</div>

										<div class="pd_l5"><strong>Longitude :</strong></div>
										<div style="padding:5px">
												<input type="text" id="event_input_longitude" class="default_input" value="{{ event.longitude }}" />
												<span class="get-coords-event" style="cursor: pointer"><img src="{{ asset('image/location_icon.png') }}" style="width:12px; height:auto" /> map</span>
										</div>
									</div>
									<div class="separator"></div>
									<div class="bloc_action" style="margin:5px">
										<span class="btn_edit standar_button">Modifier</span>
										<button class="btn_save standar_button" id="btn_doedit_event" type="submit" form="form_event_edit" value="Submit" style="display:none">Enregistrer</button>
										<span class="btn_reset standar_button" style="display:none">Annuler</span>
										<span class="btn_loading" style="display:none;padding:5px;border:1px solid transparent;margin: 0px 5px 0px 0px;"><img src="{{ asset('image/tail-spin.svg') }}" style="width: 20px; height: auto"/>Chargement...</span>
									</div>
								</div>
							</form>
						</div>
						<div class="both"></div>
					</div>
				{% else %}
					<div class="meta_info mg_v10">
						<div class="meta_illustration" id="change_illustration_fix">
                            {# twig extension #}
                            {% set illustration = eventIllustration(event) %}
							<label>
								<img id="event_illustration_fix" class="600x250" src="{{ illustration | imagine_filter('600x250') }}" alt="img event" />
							</label>
						</div>

						<div class="meta_title">
							<div class="pd_l5"><strong>Titre :</strong></div>
							<div style="padding:5px"><span id="event_view_title">{{ event.title }}</span></div>
							<div class="pd_l5"><strong>Slug :</strong></div>
							<div style="padding:5px"><span id="event_view_slug">{{ event.slug }}</span></div>
						</div>
						<div class="both"></div>
					</div>
				{% endif %}

				<div class="sep"></div>

                {% if event.tovalid == false or event.valid %}
					<div class="bloc_editable">
						<div class="bloc_view">
							<div style="">
								<div style="margin: 5px 0;">
									<strong>Introduction :</strong>
								</div>
								<div id="" class="event_view_introduction" style="padding:5px;background:#fff; border-radius:4px;border:1px solid #eee">
									{{ event.introduction }}
								</div>
							</div>

							<div style="">
								<div style="margin: 5px 0;">
									<strong>Contenu :</strong>
								</div>
								<div id="" class="event_view_content" style="padding:5px;background:#fff; border-radius:4px;border:1px solid #eee">
									{{ event.content | raw }}
								</div>
							</div>
						</div>
						<div class="bloc_edit" style="display:none">
							<div style="">
								<div style="margin: 5px 0;">
									Introduction :
								</div>
								<div>
									<textarea id="" class="event_input_introduction default_textarea">{{ event.introduction }}</textarea>
								</div>
							</div>
							<div style="">
								<div style="margin: 5px 0;">
									Contenu :
								</div>
								<div>
									<textarea id="event_input_content" class="event_input_content default_textarea tinymce">{{ event.content | raw }}</textarea>
								</div>

								<script type="text/javascript">
									var CKEDITOR_BASEPATH = "/bundles/fosckeditor/";
								</script>
								<script type="text/javascript" src="/bundles/fosckeditor/ckeditor.js"></script>
								<script type="text/javascript">
									if (CKEDITOR.instances["event_input_content"]) {
										CKEDITOR.instances["event_input_content"].destroy(true);
										delete CKEDITOR.instances["event_input_content"];
									}
									CKEDITOR.replace("event_input_content", {"uiColor":"#eeeeee","language":"en"});
								</script>
							</div>
						</div>
						<div class="separator"></div>
						<div class="bloc_action mg_v10">
							<span class="btn_edit standar_button">Modifier</span>
							<span class="btn_doedit_content_event btn_save standar_button" id="" data-target="{{ path('event_manager_doedit_content', {'event_id': event.id}) }}" style="display:none">Enregistrer</span>
							<span class="btn_reset standar_button" style="display:none">Annuler</span>
							<span class="btn_loading" style="display:none;padding:5px;border:1px solid transparent;margin: 0px 5px 0px 0px;"><img src="{{ asset('image/tail-spin.svg') }}" style="width:16px; height:16px; "/>Chargement...</span>
						</div>
					</div>
                {% else %}
					<div style="">
						<div style="margin: 5px 0;">
							<strong>Introduction :</strong>
						</div>
						<div id="" class="event_view_introduction" style="padding:5px;background:#fff; border-radius:4px;border:1px solid #eee">
							{{ event.introduction }}
						</div>
					</div>

					<div style="">
						<div style="margin: 5px 0;">
							<strong>Contenu :</strong>
						</div>
						<div id="" class="event_view_content" style="padding:5px;background:#fff; border-radius:4px;border:1px solid #eee">
							{{ event.content | raw }}
						</div>
					</div>
                {% endif %}

                {{ include("event/include/footer_event_edit.html.twig") }}
			</div>
		</div>
	</div>
{% endblock %}
