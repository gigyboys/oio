{% extends "back.html.twig" %}

{% block title %}
  Edition du filière {{ field.name }}
{% endblock %}

{% block body_header %}
	<div class="bc">
		<span class="bc1"><a href="{{ path('admin_school') }}"><img src="{{ asset('image/sl_icon.png') }}" style="width:14px; height:auto" /> <span>Etablissement</span></a> </span>
		<span class="dd">
			<span href="#" class="dds">
				<span class="bcdd"></span>
			</span>
			{{ include("admin/school/include/school_principal_action.html.twig") }}
		</span> 
		<span class="bc1"><a href="{{ path('admin_school_edit', {'id': school.id}) }}">{% if school.shortName != "" %}{{ school.shortName }}{% else %}{{ school.name }}{% endif %}</a></span>
		<span class="dd">
			<span href="#" class="dds">
				<span class="bcdd"></span>
			</span>
			{{ include("admin/school/include/school_other_action.html.twig") }}
		</span> 
		<span class="bc1"><a href="{{ path('admin_school_field', {'school_id': school.id}) }}"><span>Filières</span></a> </span>
		<span class="dd">
			<span href="#" class="dds">
				<span class="bcdd"></span>
			</span>
			<span class="ddt dd_tdfault">
				<a class="link dd_item" href="{{ path('admin_school_field_add', {'school_id': school.id}) }}">
					<span class="icon"><img src="{{ asset('image/add_icon.png') }}" /></span><span class="label">Nouvelle filière</span>
				</a>
				<span class="sp"></span>
                {% for field in fields %}
					<a class="link dd_item" href="{{ path('admin_school_field_edit', {'school_id': school.id, 'field_id': field.id}) }}">
						<span class="icon"><img src="{{ asset('image/default_icon.png') }}" /></span><span class="label">{{ field.name }}</span>
					</a>
                {% endfor %}
			</span>
		</span> 
		<span class="bc1"><a href="{{ path('admin_school_field_edit', {'school_id': school.id, 'field_id': field.id}) }}">{{ field.name }}</a></span>
	</div>
	<div style="padding:8px; float:right">
		<div style="float:left">
			<span class="dd" style="display:inline-block;">
				<span href="#" class="dds" style="cursor:pointer">
					Autres actions
				</span>
				{{ include("admin/school/include/school_other_action.html.twig") }}
			</span> 
		</div>
	</div>
{% endblock %}

{% block content_body %}
	<div>
		<div style="float:left; height: 86px;margin:5px">
			{# twig extension #}
			{% set logo = schoolLogo(school) %}
			<img id="school_logo" style="width: 80px; height: 80px" src="{{ logo | imagine_filter('80x80') }}" alt="img sl" />
		</div>
		<div style="margin-left: 90px;">
			<div>
				<table>
					<tr>
						<td>Name</td>
						<td>:</td>
						<td style="padding:5px"><span id="sl_view_name">{{ school.name }}</span></td>
					</tr>
					<tr>
						<td>ShortName</td>
						<td>:</td>
						<td style="padding:5px"><span id="sl_view_shortname">{{ school.shortName }}</span></td>
					</tr>
					<tr>
						<td>Slug</td>
						<td>:</td>
						<td style="padding:5px"><span id="sl_view_slug">{{ school.slug }}</span></td>
					</tr>
				</table>
			</div>
		</div>
		<div class="both"></div>
	</div>
	
	<div style="background:#ddd; padding: 5px; margin:5px; border:1px solid #bbb">
		<span><img src="{{ asset('image/edit_icon.png') }}" style="width:12px; height:auto" /> Edition de la filière <strong>{{ field.name }}</strong></span>
		<span class="add_field_btn" data-target="{{ path('admin_school_field_add_ajax', {'school_id': school.id}) }}" style="cursor:pointer; display: inline-block; float: right"> <img src="{{ asset('image/add_icon.png') }}" style="width:12px; height:auto" />  Nouvelle filière</span>
	</div>
	
	<div>
		<div>
			<div style="padding:5px">
				<div class="bloc_editable">
					<div class="bloc_view">
						<table style="width: 100%">
							<tr>
								<td style="width: 0.1%"><i>Nom</i></td>
								<td style="width: 0.1%">:</td>
								<td style="padding:5px"><span id="field_view_name">{{ field.name }}</span></td>
							</tr>
							<tr>
								<td><i>Slug</i></td>
								<td>:</td>
								<td style="padding:5px"><span id="field_view_slug">{{ field.slug }}</span></td>
							</tr>
							<tr>
								<td class="vatop"><i>Description</i></td>
								<td class="vatop">:</td>
								<td style="padding:5px">
									<div id="field_view_description">
                                        {{ field.description | raw }}
									</div>
								</td>
							</tr>
						</table>
					</div>
					<div class="bloc_edit" style="display:none">
						<table style="width: 100%">
							<tr>
								<td style="width: 0.1%">nom</td>
								<td style="width: 0.1%">:</td>
								<td style="padding:5px"><input type="text" id="field_input_name" class="default_input" value="{{ field.name }}" /></td>
							</tr>
							<tr>
								<td>Slug</td>
								<td>:</td>
								<td style="padding:5px"><input type="text" id="field_input_slug" class="default_input" value="{{ field.slug }}" /></td>
							</tr>
							<tr>
								<td class="vatop">Description</td>
								<td class="vatop">:</td>
								<td style="padding:5px">
									<div>
										<textarea id="field_input_description" class="field_input_description default_textarea tinymce" data-theme="advanced">{{ field.description | raw }}</textarea>
									</div>
								</td>

                                <script type="text/javascript">
                                    var CKEDITOR_BASEPATH = "/bundles/fosckeditor/";
                                </script>
                                <script type="text/javascript" src="/bundles/fosckeditor/ckeditor.js"></script>
                                <script type="text/javascript">
                                    if (CKEDITOR.instances["field_input_description"]) {
                                        CKEDITOR.instances["field_input_description"].destroy(true);
                                        delete CKEDITOR.instances["field_input_description"];
                                    }
                                    CKEDITOR.replace("field_input_description", {"uiColor":"#eeeeee","language":"fr"});
                                </script>
							</tr>
						</table>
					</div>
					<div class="separator"></div>
					<div class="bloc_action" style="margin:5px">
						<span class="btn_edit standar_button"><img src="{{ asset('image/edit_icon.png') }}" style="width:12px; height:auto" /> Modifier</span>
						<span class="btn_save standar_button" id="btn_save_field_common" data-target="{{ path('admin_school_field_doedit', {'school_id': school.id, 'field_id': field.id}) }}" style="display:none"><img src="{{ asset('image/save_icon.png') }}" style="width:12px; height:auto" /> Enregistrer</span>
						<span class="btn_reset standar_button" style="display:none"><img src="{{ asset('image/reset_icon.png') }}" style="width:12px; height:auto" /> Annuler</span>
						<span class="btn_loading" style="display:none;padding:5px;border:1px solid transparent;margin: 0px 5px 0px 0px;"><img src="{{ asset('image/tail-spin.svg') }}" style="width: 20px;height: 20px"/>Chargement...</span>
					</div>
				</div>
			</div>
			<div class="both"></div>
		</div>
	</div>
{% endblock %}

{% block body_footer %}
	<div style="padding-top: 8px">
		<span class="toggle_publishState" data-target="{{ path('admin_school_field_toggle_publication', {'school_id': school.id, 'field_id': field.id}) }}">
			{% if field.published %}
				<span class="greenstate" style="display:none"><span class="greenpastille"></span> <span>Publier</span></span>
				<span class="redstate"><span class="redpastille"></span> <span>Ne pas publier</span></span>
			{% else %}
				<span class="greenstate"><span class="greenpastille"></span> <span>Publier</span></span>
				<span class="redstate" style="display:none"><span class="redpastille"></span> <span>Ne pas publier</span></span>
			{% endif %}
		</span><span class="state_loading" style="display:none">
			<img src="{{ asset('image/tail-spin.svg')  }}" style="width:10px; height:10px;display: inline-block; vertical-align: middle;" /> Chargement...
		</span>
	</div> 
{% endblock %}

